# SPDX-License-Identifier: GPL-2.0

obj-$(CONFIG_XOR_BLOCKS)	+= xor.o

xor-y				+= xor-core.o
xor-y				+= xor-8regs.o
xor-y				+= xor-32regs.o
xor-y				+= xor-8regs-prefetch.o
xor-y				+= xor-32regs-prefetch.o

xor-$(CONFIG_ALPHA)		+= alpha/xor.o
xor-$(CONFIG_ARM)		+= arm/xor.o
ifeq ($(CONFIG_ARM),y)
xor-$(CONFIG_KERNEL_MODE_NEON)	+= arm/xor-neon.o arm/xor-neon-glue.o
else
xor-$(CONFIG_KERNEL_MODE_NEON)	+= arm64/xor-neon.o arm64/xor-neon-glue.o
endif
xor-$(CONFIG_CPU_HAS_LSX)	+= loongarch/xor_simd.o
xor-$(CONFIG_CPU_HAS_LSX)	+= loongarch/xor_simd_glue.o
xor-$(CONFIG_ALTIVEC)		+= powerpc/xor_vmx.o powerpc/xor_vmx_glue.o
xor-$(CONFIG_RISCV_ISA_V)	+= riscv/xor.o riscv/xor-glue.o
xor-$(CONFIG_SPARC32)		+= sparc/xor-sparc32.o
xor-$(CONFIG_SPARC64)		+= sparc/xor-vis.o sparc/xor-vis-glue.o
xor-$(CONFIG_SPARC64)		+= sparc/xor-niagara.o sparc/xor-niagara-glue.o
xor-$(CONFIG_S390)		+= s390/xor.o


CFLAGS_arm/xor-neon.o		+= $(CC_FLAGS_FPU)
CFLAGS_REMOVE_arm/xor-neon.o	+= $(CC_FLAGS_NO_FPU)

CFLAGS_arm64/xor-neon.o		+= $(CC_FLAGS_FPU)
CFLAGS_REMOVE_arm64/xor-neon.o	+= $(CC_FLAGS_NO_FPU)

CFLAGS_powerpc/xor_vmx.o	+= -mhard-float -maltivec \
				   $(call cc-option,-mabi=altivec) \
				   -isystem $(shell $(CC) -print-file-name=include)
